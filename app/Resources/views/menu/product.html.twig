{% extends 'base.html.twig' %}
{% block title %}{{ dict.websiteName }} - {{ viewModel.product.productName }}{% endblock %}
{% block body %}
    {# @var information \AppBundle\Service\TwigInformer #}
    {# @var twigUtil \AppBundle\Utils\TwigUtil #}
    <div class="container pt-2 max-width-container bg-container mt-container pb-container">
        {% block productSection %}
            <h2 class="fat-text">
                <span class="font-kirang-hearang" style="font-size: 1.4em;">{{ viewModel.product.productName }}</span>
            </h2>
            <small>
                <a href="{{ path('category_details', {'catName':viewModel.product.category.latinName}) }}">
                    {{ twigUtil.categoryName(viewModel.product.category, dict.localLang) }}
                </a>
            </small>
            <hr>
            <section class="product-section clearfix" id="product-holding-section">
                <div class="row">
                    <div class="col-lg-9">
                        {% if is_granted('ROLE_ADMIN') %}
                            <div class="mt-2 mb-2">
                                <a href="/products/edit/{{ viewModel.product.id }}" class="btn btn-outline-dark">
                                    Редакция
                                </a>
                            </div>
                        {% endif %}
                        {% embed 'products/partials/'~ viewModel.product.productType ~ '/product-details.html.twig' with {'product':viewModel.product, 'gallery': viewModel.gallery} %} {% endembed %}
                        {% block additionalInfoSection %}
                            <section class="mt-2">
                                {% embed 'products/partials/'~ viewModel.product.productType ~ '/' ~ dict.localLang ~  '/additional-info.html.twig' with {'product':viewModel.product} %} {% endembed %}
                            </section>
                        {% endblock %}
                    </div>
                    {% embed 'partials/sidebar/sidebar.html.twig' %}
                        {% block sidebarBody %}
                            {% embed 'partials/sidebar/categories-sidebar-html.twig' with {'categories':viewModel.categories} %} {% endembed %}
                            {% embed 'partials/sidebar/similar-products.html.twig' with
                                {'categoryName':twigUtil.categoryName(viewModel.product.category, dict.localLang), 'products':viewModel.similar} %}
                            {% endembed %}
                        {% endblock %}
                    {% endembed %}
                </div>
            </section>
        {% endblock %}
    </div>

    {% embed 'partials/modal/modal-template.html.twig' with {'modalId':'zoomImageModal'} %}
        {% block modalContent %}
            <img src="#" id="zoomedImage" style="max-width: 100%;" class="rounded">
            <p id="zoomedImageMsg"></p>
        {% endblock %}
    {% endembed %}

    {% embed 'partials/modal/modal-template.html.twig' with {'modalId':'contactUsModal'} %}
        {% block modalContent %}
            <div style="max-width: 400px;" class="m-auto">
                <h2>{{ dict.contacts }}</h2>
                {% embed 'partials/forms/contact-form-fields.html.twig' with {'about':viewModel.product.productName ~ '\r\n'} %} {% endembed %}
            </div>
        {% endblock %}
    {% endembed %}

{% endblock %}

{% block stylesheets %}
    <link type="text/css" rel="stylesheet" href="{{ asset('style/css/product-details.css') }}">
{% endblock %}
{% block javascripts %}
    <script src="{{ asset('style/js/product-details.js') }}"></script>
    <script>
        var zoomImageModal = new ModalManager('zoomImageModal', '');
        var zoomedImage = $('#zoomedImage');
        var zoomedImageMsg = $('#zoomedImageMsg');
        zoomedImage.css('max-height', $(window).height() / 1.5);

        $('#productHighlightedPicture').on('click', function (e) {
            zoomedImage.attr('src', $(this).attr('src'));
            zoomedImageMsg.html($(this).attr('alt'));
            zoomImageModal.showModal();
        });
    </script>
    <script>
        var quickContactsModal = new  ModalManager('contactUsModal', 'quick-contact-btn');
    </script>
{% endblock %}
